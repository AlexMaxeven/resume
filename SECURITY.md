# üîí –ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ XSS —Ç–∞ CSRF –∞—Ç–∞–∫

–¶–µ–π –¥–æ–∫—É–º–µ–Ω—Ç –ø–æ—è—Å–Ω—é—î, —è–∫ –ø—Ä–∞—Ü—é—î —Å–∏—Å—Ç–µ–º–∞ –∑–∞—Ö–∏—Å—Ç—É –≤—ñ–¥ XSS (Cross-Site Scripting) —Ç–∞ CSRF (Cross-Site Request Forgery) –∞—Ç–∞–∫ —É –ø—Ä–æ–µ–∫—Ç—ñ.

## üìã –ó–º—ñ—Å—Ç

1. [XSS –∑–∞—Ö–∏—Å—Ç (DOMPurify)](#xss-–∑–∞—Ö–∏—Å—Ç-dompurify)
2. [CSRF –∑–∞—Ö–∏—Å—Ç](#csrf-–∑–∞—Ö–∏—Å—Ç)
3. [–Ø–∫ —Ü–µ –ø—Ä–∞—Ü—é—î](#—è–∫-—Ü–µ-–ø—Ä–∞—Ü—é—î)
4. [–ü—Ä–∏–∫–ª–∞–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è](#–ø—Ä–∏–∫–ª–∞–¥–∏-–≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è)

---

## üõ°Ô∏è XSS –∑–∞—Ö–∏—Å—Ç (DOMPurify)

### –©–æ —Ç–∞–∫–µ XSS?

**XSS (Cross-Site Scripting)** - —Ü–µ –∞—Ç–∞–∫–∞, –∫–æ–ª–∏ –∑–ª–æ–≤–º–∏—Å–Ω–∏–π JavaScript –∫–æ–¥ –≤–ø—Ä–æ–≤–∞–¥–∂—É—î—Ç—å—Å—è –Ω–∞ –≤–µ–±-—Å—Ç–æ—Ä—ñ–Ω–∫—É —á–µ—Ä–µ–∑ –Ω–µ–±–µ–∑–ø–µ—á–Ω–∏–π –≤–≤—ñ–¥ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.

**–ü—Ä–∏–∫–ª–∞–¥ –∞—Ç–∞–∫–∏:**
```html
<!-- –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–≤–æ–¥–∏—Ç—å —É —Ñ–æ—Ä–º—É: -->
<script>alert('XSS –∞—Ç–∞–∫–∞!')</script>

<!-- –Ø–∫—â–æ –Ω–µ –∑–∞—Ö–∏—â–µ–Ω–æ, —Ü–µ–π –∫–æ–¥ –≤–∏–∫–æ–Ω–∞—î—Ç—å—Å—è -->
```

### –Ø–∫ –ø—Ä–∞—Ü—é—î DOMPurify?

**DOMPurify** - —Ü–µ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∞, —è–∫–∞ –æ—á–∏—â–∞—î HTML –≤—ñ–¥ –Ω–µ–±–µ–∑–ø–µ—á–Ω–∏—Ö –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ —Ç–∞ –∞—Ç—Ä–∏–±—É—Ç—ñ–≤.

#### 1. **–°–∞–Ω—ñ—Ç–∏–∑–∞—Ü—ñ—è HTML** (`utils/sanitize.js`)

```javascript
import { sanitizeHTML } from './utils/sanitize';

// –ù–µ–±–µ–∑–ø–µ—á–Ω–∏–π –≤–≤—ñ–¥
const dangerousInput = '<script>alert("XSS")</script><p>–ë–µ–∑–ø–µ—á–Ω–∏–π —Ç–µ–∫—Å—Ç</p>';

// –ë–µ–∑–ø–µ—á–Ω–∏–π –≤–∏–≤—ñ–¥ (script —Ç–µ–≥ –≤–∏–¥–∞–ª–µ–Ω–æ)
const safeOutput = sanitizeHTML(dangerousInput);
// –†–µ–∑—É–ª—å—Ç–∞—Ç: '<p>–ë–µ–∑–ø–µ—á–Ω–∏–π —Ç–µ–∫—Å—Ç</p>'
```

**–©–æ –≤–∏–¥–∞–ª—è—î—Ç—å—Å—è:**
- `<script>` —Ç–µ–≥–∏
- `<iframe>`, `<object>`, `<embed>`
- –ê—Ç—Ä–∏–±—É—Ç–∏ `onclick`, `onerror`, `onload` (event handlers)
- –ü—Ä–æ—Ç–æ–∫–æ–ª–∏ `javascript:`, `data:`, `vbscript:`
- `style` –∞—Ç—Ä–∏–±—É—Ç–∏ (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º)

**–©–æ –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è:**
- –ë–µ–∑–ø–µ—á–Ω—ñ —Ç–µ–≥–∏: `<p>`, `<strong>`, `<em>`, `<a>`, `<h1-h6>`, —Ç–æ—â–æ
- –ë–µ–∑–ø–µ—á–Ω—ñ –∞—Ç—Ä–∏–±—É—Ç–∏: `href`, `title`, `class`, `id`

#### 2. **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç SafeHTML** (`components/SafeHTML/SafeHTML.jsx`)

```jsx
import SafeHTML from './components/SafeHTML/SafeHTML';

// –ë–µ–∑–ø–µ—á–Ω–∏–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ HTML
<SafeHTML 
  content="<p>–¢–µ–∫—Å—Ç –∑ <strong>HTML</strong></p>" 
  tag="div"
/>
```

**–Ø–∫ –ø—Ä–∞—Ü—é—î:**
1. –ö–æ–Ω—Ç–µ–Ω—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å–∞–Ω—ñ—Ç–∏–∑—É—î—Ç—å—Å—è —á–µ—Ä–µ–∑ DOMPurify
2. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è `dangerouslySetInnerHTML`, –∞–ª–µ –∑ **–ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ –æ—á–∏—â–µ–Ω–∏–º** HTML
3. –ù–µ–±–µ–∑–ø–µ—á–Ω—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ –≤–∏–¥–∞–ª—è—é—Ç—å—Å—è –¥–æ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥—É

#### 3. **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ –Ω–µ–±–µ–∑–ø–µ—á–Ω–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç**

```javascript
import { containsDangerousContent } from './utils/sanitize';

if (containsDangerousContent(userInput)) {
  console.warn('–í–∏—è–≤–ª–µ–Ω–æ –Ω–µ–±–µ–∑–ø–µ—á–Ω–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç!');
  // –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å–∞–Ω—ñ—Ç–∏–∑—É—î—Ç—å—Å—è
}
```

---

## üîê CSRF –∑–∞—Ö–∏—Å—Ç

### –©–æ —Ç–∞–∫–µ CSRF?

**CSRF (Cross-Site Request Forgery)** - —Ü–µ –∞—Ç–∞–∫–∞, –∫–æ–ª–∏ –∑–ª–æ–≤–º–∏—Å–Ω–∏–π —Å–∞–π—Ç –≤–∏–∫–æ–Ω—É—î –¥—ñ—ó –≤—ñ–¥ —ñ–º–µ–Ω—ñ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –±–µ–∑ –π–æ–≥–æ –≤—ñ–¥–æ–º–∞.

**–ü—Ä–∏–∫–ª–∞–¥ –∞—Ç–∞–∫–∏:**
```html
<!-- –ó–ª–æ–≤–º–∏—Å–Ω–∏–π —Å–∞–π—Ç –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î –∑–∞–ø–∏—Ç: -->
<img src="https://bank.com/transfer?to=hacker&amount=1000" />

<!-- –Ø–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –∑–∞–ª–æ–≥—ñ–Ω–µ–Ω–∏–π —É –±–∞–Ω–∫—É, –∑–∞–ø–∏—Ç –≤–∏–∫–æ–Ω–∞—î—Ç—å—Å—è! -->
```

### –Ø–∫ –ø—Ä–∞—Ü—é—î CSRF –∑–∞—Ö–∏—Å—Ç?

#### 1. **–ì–µ–Ω–µ—Ä–∞—Ü—ñ—è —Ç–æ–∫–µ–Ω—É** (`utils/csrf.js`)

```javascript
import { initCSRFToken, getCSRFToken } from './utils/csrf';

// –ì–µ–Ω–µ—Ä—É—î —Ç–∞ –∑–±–µ—Ä—ñ–≥–∞—î —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π —Ç–æ–∫–µ–Ω
const token = initCSRFToken();
// –ü—Ä–∏–∫–ª–∞–¥: "a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6"
```

**–î–µ –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è:**
- `localStorage` (–¥–ª—è –∫–ª—ñ—î–Ω—Ç–∞)
- Cookie (–¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞, —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ)

#### 2. **–î–æ–¥–∞–≤–∞–Ω–Ω—è —Ç–æ–∫–µ–Ω—É –¥–æ –∑–∞–ø–∏—Ç—ñ–≤**

```javascript
import { secureFetch } from './utils/csrf';

// –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –¥–æ–¥–∞—î CSRF —Ç–æ–∫–µ–Ω –¥–æ –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤
const response = await secureFetch('/api/contact', {
  method: 'POST',
  body: JSON.stringify({ name: 'John', message: 'Hello' })
});

// –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –¥–æ–¥–∞—î—Ç—å—Å—è:
// X-CSRF-Token: a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6
```

#### 3. **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ**

–°–µ—Ä–≤–µ—Ä –ø–æ–≤–∏–Ω–µ–Ω:
1. –û—Ç—Ä–∏–º–∞—Ç–∏ —Ç–æ–∫–µ–Ω –∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞ `X-CSRF-Token`
2. –ü–æ—Ä—ñ–≤–Ω—è—Ç–∏ –∑ —Ç–æ–∫–µ–Ω–æ–º, –∑–±–µ—Ä–µ–∂–µ–Ω–∏–º —É —Å–µ—Å—ñ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
3. –í—ñ–¥—Ö–∏–ª–∏—Ç–∏ –∑–∞–ø–∏—Ç, —è–∫—â–æ —Ç–æ–∫–µ–Ω–∏ –Ω–µ —Å–ø—ñ–≤–ø–∞–¥–∞—é—Ç—å

**–ü—Ä–∏–∫–ª–∞–¥ —Å–µ—Ä–≤–µ—Ä–Ω–æ—ó –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ (Node.js/Express):**
```javascript
app.post('/api/contact', (req, res) => {
  const clientToken = req.headers['x-csrf-token'];
  const serverToken = req.session.csrfToken;
  
  if (clientToken !== serverToken) {
    return res.status(403).json({ error: 'Invalid CSRF token' });
  }
  
  // –ë–µ–∑–ø–µ—á–Ω–∏–π –∑–∞–ø–∏—Ç
  // ...
});
```

---

## üîÑ –Ø–∫ —Ü–µ –ø—Ä–∞—Ü—é—î —Ä–∞–∑–æ–º

### –°—Ü–µ–Ω–∞—Ä—ñ–π 1: –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–≤–æ–¥–∏—Ç—å –Ω–µ–±–µ–∑–ø–µ—á–Ω–∏–π HTML

```
1. –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–≤–æ–¥–∏—Ç—å: <script>alert('XSS')</script>
2. containsDangerousContent() –≤–∏—è–≤–ª—è—î –Ω–µ–±–µ–∑–ø–µ—á–Ω–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç
3. –ü–æ–∫–∞–∑—É—î—Ç—å—Å—è –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è ‚ö†Ô∏è
4. sanitizeHTML() –≤–∏–¥–∞–ª—è—î <script> —Ç–µ–≥
5. SafeHTML —Ä–µ–Ω–¥–µ—Ä–∏—Ç—å –±–µ–∑–ø–µ—á–Ω–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç
6. –†–µ–∑—É–ª—å—Ç–∞—Ç: (–ø—É—Å—Ç–æ, –±–æ script –≤–∏–¥–∞–ª–µ–Ω–æ)
```

### –°—Ü–µ–Ω–∞—Ä—ñ–π 2: –í—ñ–¥–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º–∏

```
1. –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –∑–∞–ø–æ–≤–Ω—é—î —Ñ–æ—Ä–º—É
2. –í—Å—ñ –¥–∞–Ω—ñ —Å–∞–Ω—ñ—Ç–∏–∑—É—é—Ç—å—Å—è (sanitizeText, sanitizeHTML)
3. CSRF —Ç–æ–∫–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –¥–æ–¥–∞—î—Ç—å—Å—è –¥–æ –∑–∞–ø–∏—Ç—É
4. secureFetch() –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î –∑–∞–ø–∏—Ç –∑ –∑–∞–≥–æ–ª–æ–≤–∫–æ–º X-CSRF-Token
5. –°–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–≤—ñ—Ä—è—î —Ç–æ–∫–µ–Ω
6. –Ø–∫—â–æ —Ç–æ–∫–µ–Ω –≤–∞–ª—ñ–¥–Ω–∏–π - –∑–∞–ø–∏—Ç –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è
7. –Ø–∫—â–æ —Ç–æ–∫–µ–Ω –Ω–µ–≤–∞–ª—ñ–¥–Ω–∏–π - –∑–∞–ø–∏—Ç –≤—ñ–¥—Ö–∏–ª—è—î—Ç—å—Å—è (403)
```

---

## üí° –ü—Ä–∏–∫–ª–∞–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### 1. –ë–µ–∑–ø–µ—á–Ω–∏–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ HTML

```jsx
import SafeHTML from './components/SafeHTML/SafeHTML';

function MyComponent() {
  const userContent = "<p>–ú—ñ–π <strong>—Ç–µ–∫—Å—Ç</strong></p><script>alert('XSS')</script>";
  
  return (
    <SafeHTML content={userContent} />
    // –†–µ–Ω–¥–µ—Ä–∏—Ç—å: <p>–ú—ñ–π <strong>—Ç–µ–∫—Å—Ç</strong></p>
    // <script> –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–¥–∞–ª–µ–Ω–æ
  );
}
```

### 2. –°–∞–Ω—ñ—Ç–∏–∑–∞—Ü—ñ—è —Ñ–æ—Ä–º–∏

```jsx
import { sanitizeText, sanitizeHTML } from './utils/sanitize';

function handleSubmit(e) {
  e.preventDefault();
  
  const sanitizedData = {
    name: sanitizeText(formData.name),      // –í–∏–¥–∞–ª—è—î HTML
    email: sanitizeText(formData.email),    // –í–∏–¥–∞–ª—è—î HTML
    message: sanitizeHTML(formData.message) // –û—á–∏—â–∞—î –≤—ñ–¥ –Ω–µ–±–µ–∑–ø–µ—á–Ω–∏—Ö —Ç–µ–≥—ñ–≤
  };
  
  // –í—ñ–¥–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–∏—Ö...
}
```

### 3. –ë–µ–∑–ø–µ—á–Ω–∏–π API –∑–∞–ø–∏—Ç

```jsx
import { secureFetch } from './utils/csrf';

async function sendData(data) {
  const response = await secureFetch('/api/endpoint', {
    method: 'POST',
    body: JSON.stringify(data)
  });
  
  // CSRF —Ç–æ–∫–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –¥–æ–¥–∞–Ω–æ –¥–æ –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤
  return response.json();
}
```

### 4. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ URL

```jsx
import { sanitizeURL } from './utils/sanitize';

const userLink = "javascript:alert('XSS')";
const safeLink = sanitizeURL(userLink);
// –†–µ–∑—É–ª—å—Ç–∞—Ç: "" (–ø–æ—Ä–æ–∂–Ω—ñ–π —Ä—è–¥–æ–∫, –±–æ –Ω–µ–±–µ–∑–ø–µ—á–Ω–∏–π –ø—Ä–æ—Ç–æ–∫–æ–ª)

const safeLink2 = sanitizeURL("https://example.com");
// –†–µ–∑—É–ª—å—Ç–∞—Ç: "https://example.com" (–±–µ–∑–ø–µ—á–Ω–∏–π)
```

---

## ‚ö†Ô∏è –í–∞–∂–ª–∏–≤—ñ –∑–∞—É–≤–∞–∂–µ–Ω–Ω—è

### 1. **DOMPurify –Ω–µ –∑–∞—Ö–∏—â–∞—î –≤—ñ–¥:**
- SQL Injection (—Ü–µ –∑–∞–≤–¥–∞–Ω–Ω—è —Å–µ—Ä–≤–µ—Ä–∞)
- CSRF (–ø–æ—Ç—Ä—ñ–±–Ω—ñ —Ç–æ–∫–µ–Ω–∏)
- Clickjacking (–ø–æ—Ç—Ä—ñ–±–Ω—ñ –∑–∞–≥–æ–ª–æ–≤–∫–∏ X-Frame-Options)

### 2. **CSRF —Ç–æ–∫–µ–Ω–∏ –ø—Ä–∞—Ü—é—é—Ç—å —Ç—ñ–ª—å–∫–∏ —è–∫—â–æ:**
- –°–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–≤—ñ—Ä—è—î —Ç–æ–∫–µ–Ω–∏
- –¢–æ–∫–µ–Ω–∏ –≥–µ–Ω–µ—Ä—É—é—Ç—å—Å—è —É–Ω—ñ–∫–∞–ª—å–Ω–æ –¥–ª—è –∫–æ–∂–Ω–æ—ó —Å–µ—Å—ñ—ó
- –¢–æ–∫–µ–Ω–∏ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –±–µ–∑–ø–µ—á–Ω–æ

### 3. **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó:**
- ‚úÖ –ó–∞–≤–∂–¥–∏ —Å–∞–Ω—ñ—Ç–∏–∑—É–π—Ç–µ –≤–≤—ñ–¥ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- ‚úÖ –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `SafeHTML` –¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥—É HTML
- ‚úÖ –î–æ–¥–∞–≤–∞–π—Ç–µ CSRF —Ç–æ–∫–µ–Ω–∏ –¥–æ –≤—Å—ñ—Ö POST/PUT/DELETE –∑–∞–ø–∏—Ç—ñ–≤
- ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä—è–π—Ç–µ —Ç–æ–∫–µ–Ω–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ
- ‚úÖ –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ HTTPS –¥–ª—è –±–µ–∑–ø–µ—á–Ω–æ—ó –ø–µ—Ä–µ–¥–∞—á—ñ —Ç–æ–∫–µ–Ω—ñ–≤

---

## üìö –î–æ–¥–∞—Ç–∫–æ–≤—ñ —Ä–µ—Å—É—Ä—Å–∏

- [DOMPurify –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è](https://github.com/cure53/DOMPurify)
- [OWASP XSS Prevention](https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html)
- [OWASP CSRF Prevention](https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html)

---

**–°—Ç–≤–æ—Ä–µ–Ω–æ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—ó –∑–∞—Ö–∏—Å—Ç—É –≤—ñ–¥ XSS/CSRF –∞—Ç–∞–∫ —É React –¥–æ–¥–∞—Ç–∫—É.**

